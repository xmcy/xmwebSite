!function(e,s){var o=e.module("layoutForloginAndReg");o.controller("regController",["$scope","$http","$window",function(e,s,o){e.messageInterval="点击发送",e.postType="bind",e.clickChange=!1,e.flag=!0,e.regUser=function(){e.errorMessage="",s.post("/users/doRegWithPhoneNum",{phoneNum:e.phoneNum,code:e.code,password:e.password,inviteCode:e.inviteCode}).success(function(s){"object"==typeof s?"success"==s.result&&(o.location.href="/users/home"):e.errorMessage=s})},e.changeForm=function(s){e.flag=1===s}}]),o.controller("loginController",["$scope","$http","$window",function(e,s,o){e.messageInterval="点击发送",e.clickChange=!1,e.flag=!0,e.autologin=!0,e.changeForm=function(s){e.errorMessage="",e.flag=1===s},e.loginUsersWithUsername=function(){e.errorMessage="",s.post("/users/doLogin",{userName:e.userName,password:e.password,autologin:e.autologin}).success(function(s){"success"==s?o.location.href="/users/home":e.errorMessage=s})},e.loginUsersWithTele=function(){e.errorMessage="",s.post("/users/doLoginWithVC",{phoneNum:e.phoneNum,code:e.code,autologin:e.autologin1}).success(function(s){"success"==s?o.location.href="/users/home":e.errorMessage=s})}}]),o.controller("passwordResetController",["$scope","$http","$window",function(s,o,r){s.errorMessage="",s.changeCode=function(){s.src="/admin/vnum?"+Math.random()},s.resetFirst=function(){s.errorMessage="",o.post("/users/checkUserExistence",{userName:s.username,vnum:s.code}).success(function(o){e.isObject(o)?(r.localStorage.setItem("user",JSON.stringify(o)),r.location.href="/users/confirmUser"):s.errorMessage=o})}}]),o.controller("confirmController",["$scope","$window","$http",function(s,o,r){s.messageInterval="获取验证码",s.user=e.fromJson(o.localStorage.getItem("user")),s.userName=s.user.userName,s.phoneNum=s.user.phoneNum,s.errorMessage="",s.resetSecond=function(){s.errorMessage="",r.post("/users/checkVerifyCode",{phoneNum:s.user.phoneNum,code:s.code}).success(function(e){"success"==e?o.location.href="/users/setPassword":s.errorMessage=e})}}]),o.controller("setPasswordController",["$scope","$window","$http",function(s,o,r){s.user=e.fromJson(o.localStorage.getItem("user")),s.userName=s.user.userName,s.errorMessage="",s.resetThird=function(){s.errorMessage="",r.post("/users/resetPsdFromForget",{id:s.user._id,password:s.password}).success(function(e){"success"==e?(o.localStorage.clear(),o.location.href="/users/login"):s.errorMessage=e})}}])}(angular,jQuery);